import{t as a}from"./plugins-DaBpnC88.js";class c extends HTMLElement{constructor(){super(),this.form=this.querySelector("#edit-tag-form"),this.formRow=this.querySelectorAll(".rz-form-field"),this.dropdown=null,this.onFormSubmit=this.onFormSubmit.bind(this)}connectedCallback(){this.form&&this.form.addEventListener("submit",this.onFormSubmit)}disconnectedCallback(){this.form&&this.form.removeEventListener("submit",this.onFormSubmit)}async onFormSubmit(e){e.preventDefault(),window.dispatchEvent(new CustomEvent("requestLoaderShow"));let r=new CustomEvent("pagechange");window.dispatchEvent(r);const t=new FormData(this.form),o=await fetch(window.location.href,{method:"POST",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:t});if(o.ok)this.cleanErrors();else{const s=await o.json();s.errors&&(this.displayErrors(s.errors),window.dispatchEvent(new CustomEvent("pushToast",{detail:{message:s.message,status:"danger"}})))}return await window.Rozier.refreshMainTagTree(),await window.Rozier.getMessages(),window.dispatchEvent(new CustomEvent("requestLoaderHide")),!1}cleanErrors(){document.querySelectorAll(".form-errored").forEach(r=>{r.classList.remove("form-errored"),r.querySelector(".error-message").remove()})}displayErrors(e,r){(!r||r===!1)&&this.cleanErrors();for(let t in e){let o=null,s=null;if(a(e[t])==="object")this.displayErrors(e[t],!0);else{o=t.replace("_","-"),e[t]instanceof Array?s=e[t][0]:s=e[t];let i=document.querySelector(".form-col-"+o);i&&(i.classList.add("form-errored"),i.insertAdjacentHTML("beforeend",'<p class="error-message uk-alert uk-alert-danger"><i class="uk-icon uk-icon-warning"></i> '+s+"</p>"))}}}}export{c as default};
