const s=class s extends HTMLElement{constructor(){super(),this.handle=null,this.isDragging=!1,this.startPointerY=0,this.startPointerX=0,this.startTop=0,this.startLeft=0,this.axis="y",this.edge="right",this.pointerId=null,this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onResize=this.onResize.bind(this)}connectedCallback(){this.handle=this.querySelector(".rz-actions-menu__handle"),this.handle&&(this.axis=this.getAxisAttribute(),this.applyInitialPosition(),this.handle.addEventListener("pointerdown",this.onPointerDown),window.addEventListener("resize",this.onResize))}disconnectedCallback(){this.handle?.removeEventListener("pointerdown",this.onPointerDown),window.removeEventListener("resize",this.onResize),this.removeDragListeners()}onPointerDown(t){t.button===0&&(this.isDragging=!0,this.pointerId=t.pointerId,this.startPointerY=t.clientY,this.startPointerX=t.clientX,this.startTop=this.getCurrentTop(),this.startLeft=this.getCurrentLeft(),this.handle?.setPointerCapture(t.pointerId),document.body.style.userSelect="none",this.addDragListeners())}onPointerMove(t){if(!this.isDragging||this.pointerId!==t.pointerId)return;const i={top:this.getClampedTop(this.startTop+(t.clientY-this.startPointerY)),axis:this.axis,edge:this.edge};if(this.axis==="xy"){const n=this.getClampedLeft(this.startLeft+(t.clientX-this.startPointerX));i.left=n,i.edge="left"}this.applyPosition(i)}onPointerUp(t){this.pointerId===t.pointerId&&(this.isDragging=!1,this.pointerId=null,this.handle?.releasePointerCapture(t.pointerId),document.body.style.userSelect="",this.removeDragListeners(),this.persistPosition())}onResize(){const t=this.getClampedTop(this.getCurrentTop());this.applyPosition({top:t,axis:this.axis,edge:this.edge})}addDragListeners(){window.addEventListener("pointermove",this.onPointerMove),window.addEventListener("pointerup",this.onPointerUp),window.addEventListener("pointercancel",this.onPointerUp)}removeDragListeners(){window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),window.removeEventListener("pointercancel",this.onPointerUp)}applyInitialPosition(){const t=this.getPersistedPosition();if(t){const n={top:this.getClampedTop(t.top),axis:this.axis,edge:t.edge};this.axis==="xy"&&typeof t.left=="number"&&(n.left=this.getClampedLeft(t.left)),this.applyPosition(n);return}const e=this.getClampedTop(this.getCurrentTop());this.applyPosition({top:e,axis:this.axis,edge:this.edge})}applyPosition(t){if(this.style.transform="none",this.style.top=`${t.top}px`,t.edge==="left")this.style.left=typeof t.left=="number"?`${t.left}px`:"0px",this.style.right="";else{const e=this.getDefaultRight();this.style.right=typeof t.right=="number"?`${t.right}px`:`${e}px`,this.style.left=""}this.dataset.edge=t.edge}getCurrentTop(){const t=window.getComputedStyle(this).top;if(t&&t!=="auto"&&t.endsWith("px")){const i=Number.parseFloat(t);if(!Number.isNaN(i))return i}return this.getBoundingClientRect().top}getCurrentLeft(){const t=window.getComputedStyle(this).left;if(t&&t!=="auto"&&t.endsWith("px")){const i=Number.parseFloat(t);if(!Number.isNaN(i))return i}return this.getBoundingClientRect().left}getDefaultRight(){const t=window.getComputedStyle(this).right;if(t&&t!=="auto"&&t.endsWith("px")){const e=Number.parseFloat(t);if(!Number.isNaN(e))return e}return 0}getAxisAttribute(){return this.getAttribute("data-axis")==="xy"?"xy":"y"}getClampedTop(t){const e=this.getBoundingClientRect(),i=Math.max(0,window.innerHeight-e.height);return Math.min(Math.max(0,t),i)}getClampedLeft(t){const e=this.getBoundingClientRect(),i=Math.max(0,window.innerWidth-e.width);return Math.min(Math.max(0,t),i)}persistPosition(){const t={top:this.getCurrentTop(),axis:this.axis,edge:this.dataset.edge==="left"?"left":"right"};this.axis==="xy"&&(t.left=this.getCurrentLeft());try{window.localStorage.setItem(s.storageKey,JSON.stringify(t))}catch(e){console.warn("RzActionsMenu: Unable to persist position.",e)}}getPersistedPosition(){try{const t=window.localStorage.getItem(s.storageKey);if(!t)return null;const e=JSON.parse(t);return typeof e.top!="number"?null:{top:e.top,left:e.left,right:e.right,axis:e.axis==="xy"?"xy":"y",edge:e.edge==="left"?"left":"right"}}catch(t){return console.warn("RzActionsMenu: Unable to read position.",t),null}}};s.storageKey="rz-actions-menu-position";let o=s;export{o as default};
