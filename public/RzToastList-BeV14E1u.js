import{r as T}from"./rzBadge-BmGDcOV7.js";import{r as p}from"./rzButton-J_yTZFMr.js";const m={success:{title:"Success",iconClass:"rz-icon-ri--check-line"},warning:{title:"Warning",iconClass:"rz-icon-ri--error-warning-line"},danger:{title:"Error",iconClass:"rz-icon-ri--prohibited-line"}},u="rz-toast-list";function C(c){const{id:t,message:e,status:s="success",title:n="",iconClass:a="",commandfor:h=u}=c,o=document.createElement("div");o.className=`rz-toast rz-toast--${s}`,o.setAttribute("role",s==="danger"?"alert":"status"),o.dataset.toastId=String(t);const l=T({iconClass:a||m[s].iconClass,size:"sm",color:s,attributes:{"aria-hidden":"true"}});l.classList.add("rz-toast__icon");const i=document.createElement("h3");i.className="rz-toast__title",i.textContent=n||m[s].title;const d=p({iconClass:"rz-icon-ri--close-line",emphasis:"tertiary",size:"xs",attributes:{type:"button","aria-label":"Close notification",commandfor:h,command:"--close-toast"}});d.classList.add("rz-toast__close"),o.appendChild(d),o.appendChild(l),o.appendChild(i);const r=document.createElement("p");return r.className="rz-toast__content",r.innerHTML=e,o.appendChild(r),o}const f=5e3;class I extends HTMLElement{constructor(){super(),this.toasts=new Map,this.toastId=0,this.onPushToast=this.onPushToast.bind(this),this.onCommand=this.onCommand.bind(this)}get elementId(){return this.id||u}onCommand(t){t.command==="--close-toast"&&this.onCloseToast(t)}onCloseToast(t){const e=t.source.closest(".rz-toast[data-toast-id]"),s=Number(e?.dataset.toastId);typeof s=="number"&&!isNaN(s)&&this.removeToast(s)}connectedCallback(){this.id||(this.id=this.elementId),this.addEventListener("command",this.onCommand),window.addEventListener("pushToast",this.onPushToast),this.flushQueuedToasts()}disconnectedCallback(){this.removeEventListener("command",this.onCommand),window.removeEventListener("pushToast",this.onPushToast),this.clearAllTimeouts(),this.toasts.clear()}pushToast(t){const e=typeof t.timeout=="number"?t.timeout:f,s=this.toastId++,n=C({id:s,message:t.message,status:t.status||"success",title:t.title,iconClass:t.iconClass,commandfor:t.commandfor||this.elementId}),a=e>0?window.setTimeout(()=>this.removeToast(s),e):null;this.toasts.set(s,{id:s,element:n,timeoutId:a}),this.prepend(n)}onPushToast(t){const s=t.detail;this.pushToast({...s,status:s.status||"success"})}flushQueuedToasts(){const t=window.__rzToastQueue;!t||t.length===0||(t.forEach(e=>this.pushToast(e)),t.length=0)}clearAllTimeouts(){this.toasts.forEach(t=>{t.timeoutId!==null&&window.clearTimeout(t.timeoutId)})}removeToast(t){const e=this.toasts.get(t);e&&(e.timeoutId!==null&&window.clearTimeout(e.timeoutId),e.element.classList.add("rz-toast--leaving"),e.element.addEventListener("animationend",()=>{e.element.remove(),this.toasts.delete(t)},{once:!0}))}}export{I as default};
