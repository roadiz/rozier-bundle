{% embed "@RoadizRozier/macros/rz_actions_menu.html.twig" with {
    vertical: true,
    class: 'actions-menu',
    document: document,
    translation: translation,
    versions: versions,
    currentVersion: currentVersion,
    readOnly: readOnly,
    loop: loop,
    max_versions_showed: max_versions_showed,
} only %}
    {% block items %}
        {% if versions and versions|length > 1 %}
            <rz-popover popover-placement="left-start" popover-offset="18px">
                <button popovertarget="version-menu"
                        class="rz-button rz-button--tertiary rz-button--md rz-button--on-dark"
                        aria-label="{% trans %}versions{% endtrans %}">
                    <span class="rz-button__icon rz-icon-ri--git-fork-line"></span>
                </button>

                {% embed "@RoadizRozier/macros/rz_dropdown_menu.html.twig" with {
                    title: 'versions',
                    reverse: true,
                    targetId: 'version-menu',
                } %}
                    {% block items %}
                        {{ _self.item({
                            label: 'versions.working_copy',
                            href: path('documentsMetaPage', {
                                documentId: document.id,
                                translationId: translation.id
                            }),
                            selected: not currentVersion,
                        }) }}
                        {% for version in versions %}
                            {% if loop.index0 > 0 and loop.index <= max_versions_showed %}
                                {{ _self.item({
                                    label: version.loggedAt|format_datetime('short', 'short', locale=app.request.locale),
                                    description: version.username,
                                    href: path('documentsMetaPage', {
                                        documentId: document.id,
                                        translationId: translation.id,
                                        version: version.version
                                    }),
                                    selected: currentVersion and currentVersion.id == version.id,
                                }) }}
                            {% endif %}
                        {% endfor %}
                    {% endblock %}
                {% endembed %}
            </rz-popover>
        {% endif %}

        {% if document.id %}
            {{ _self.item(
                label: 'download.document',
                class: 'rz-button--tertiary rz-no-ajax-link',
                href: path('documentsDownloadPage', { documentId: document.id}),
                icon: 'rz-icon-ri--download-line'
            ) }}
        {% endif %}

        {% if (is_granted('ROLE_ACCESS_DOCUMENTS_DELETE') and not readOnly) %}
            {% if document.id %}
                {{ _self.item(
                    label: 'delete.document',
                    class: 'rz-button--primary rz-button--danger',
                    href: path('documentsDeletePage', { documentId: document.id}),
                    icon: 'rz-icon-ri--delete-bin-7-line'
                ) }}
            {% endif %}
        {% endif %}
    {% endblock %}
{% endembed %}
