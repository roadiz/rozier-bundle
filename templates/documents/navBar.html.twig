{% set editRouteParams = { documentId: document.id } %}

{% if app.request and app.request.get('referer') %}
    {% set editRouteParams = editRouteParams|merge({ referer: app.request.get('referer') }) %}
{% endif %}

{%
set listItems = [
    [
        {
            'name': 'edit',
            'label': 'document.edit',
            'href': path('documentsEditPage', editRouteParams),
        },
        {
            'name': 'metas',
            'label': 'document.metas',
            'href': path('documentsMetaPage', editRouteParams),
        },
        is_granted('ROLE_ACCESS_DOCUMENTS_LIMITATIONS') ? {
            'name': 'limitations',
            'label': 'document.limitations',
            'href': path('documentsLimitationsPage', { id: document.id, referer: app.request.get('referer') }),
        } : null,
        {
            'name': 'preview',
            'label': 'document.preview',
            'href': path('documentsPreviewPage', editRouteParams),
        },
        {
            'name': 'usage',
            'label': 'document.usage',
            'href': path('documentsUsagePage', editRouteParams),
        }
    ],
    [
        document and document.image ? {
            'name': 'adjust',
            'label': 'document.adjust',
            'href': path('documentsAdjustPage', editRouteParams),
            'icon': 'rz-icon-ri--crop-line',
            'iconOnly': true,
        } : null,
    ]
]
%}
{% set custom_entries_content %}
    {% block additional_entries %}{% endblock %}
{% endset %}

{% embed "@RoadizRozier/macros/rz_menu_bar.html.twig" with {listItems : listItems, current: current} %}
    {% block additional_entries %}
        {{ custom_entries_content|raw }}
    {% endblock %}
{% endembed %}
