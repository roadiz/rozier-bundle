{% extends "@RoadizRozier/documents/list.html.twig" %}

{% block content_body %}
    <article>
        {% block pre_content_body %}{% endblock %}

        {% embed '@RoadizRozier/includes/rz_table.html.twig' with {
            selection_available: true,
            actions_available: true,
        } %}
            {% block thead_cells %}
                <th class="mobile-hidden"></th>
                <th>
                    {% if not no_sorting %}
                        {% include '@RoadizRozier/includes/column_ordering.html.twig' with {
                            'field': 'filename',
                            'label': 'document.filename'|trans,
                        } %}
                    {% endif %}
                </th>
                <th class="mobile-hidden">
                    {% if not no_sorting %}
                        {% include '@RoadizRozier/includes/column_ordering.html.twig' with {
                            'field': 'createdAt',
                            'label': 'document.createdAt'|trans,
                        } %}
                    {% endif %}
                </th>
                <th class="mobile-hidden">
                    {% if not no_sorting %}
                        {% include '@RoadizRozier/includes/column_ordering.html.twig' with {
                            'field': 'mimeType',
                            'label': 'document.mimeType'|trans,
                        } %}
                    {% endif %}
                </th>
                <th>
                    {% if not no_sorting %}
                        {% include '@RoadizRozier/includes/column_ordering.html.twig' with {
                            'field': 'filesize',
                            'label': 'document.filesize'|trans,
                        } %}
                    {% endif %}
                </th>
                <th class="mobile-hidden uk-visible-xlarge">
                    {% if not no_sorting %}
                        {% include '@RoadizRozier/includes/column_ordering.html.twig' with {
                            'field': 'imageWidth',
                            'label': 'document.width'|trans,
                        } %}
                    {% endif %}
                </th>
                <th class="mobile-hidden uk-visible-xlarge">
                    {% if not no_sorting %}
                        {% include '@RoadizRozier/includes/column_ordering.html.twig' with {
                            'field': 'imageHeight',
                            'filters': filters,
                            'label': 'document.height'|trans
                        } %}
                    {% endif %}
                </th>
                <th class="mobile-hidden uk-visible-xlarge"></th>
            {% endblock %}

            {% block tbody_content %}
                {% import '@RoadizRozier/macros/rz_badge.html.twig' as rz_badge %}
                {% for document in documents %}
                    <tr
                     {{ _self.colored_row_attrs({'color': document.imageAverageColor }) }}
                    >
                        {% if selection_available %}
                        <td>
					        {% import '@RoadizRozier/macros/rz_bulk.html.twig' as rz_bulk %}
                            {{ rz_bulk.select_input({ value: document.id }) }}
                        </td>
                        {% endif %}
                        <td class="mobile-hidden">
                            <figure class="document-image">
                                {% if not document.private and (document.isImage or document.isSvg or document.hasThumbnails) %}
                                    {{ document|display({
                                        picture: true,
                                        align: document.imageCropAlignment,
                                        hotspot: document.hotspotAsString,
                                        width: 64,
                                        crop: '1:1',
                                        quality: 60
                                    }) }}
                                {% endif %}
                                {% if not (document.isImage or document.isSvg) and document.shortType != 'unknown' %}
                                    {{ rz_badge.item({
                                        icon: 'rz-icon-ri--file-' ~ document.shortType ~ '-line',
                                        size: 'md',
                                    })}}
                                {% endif %}
                            </figure>
                        </td>
                        <td>
                            <a
                                class="rz-table__link"
                                href="{{ path('documentsEditPage', { documentId: document.id }) }}"
                            >
                                {{ document|centralTruncate(30, -4) }}
                            </a>
                        </td>
                        <td class="mobile-hidden">
                            {{ document.createdAt|format_datetime('short', 'short') }}
                        </td>
                        <td class="mobile-hidden">{{ document.mimeType }}</td>
                        <td>
                            {% if document.filesize > 0 %}<span class="rz-icon-ri--eye-line"></span> {{ document.filesize|formatBytes }}{% endif %}
                            {% if document.rawDocument %}
                                {% if document.rawDocument.filesize > 0 %}
                                    <br>
                                    <span class="rz-icon-ri--camera-line" title="{{ 'original.document'|trans }}"></span> {{ document.rawDocument.filesize|formatBytes }}
                                {% endif %}
                            {% endif %}
                        </td>
                        <td class="mobile-hidden uk-visible-xlarge">{% if document.imageWidth > 0 %}{{ document.imageWidth }}px{% endif %}</td>
                        <td class="mobile-hidden uk-visible-xlarge">{% if document.imageHeight > 0 %}{{ document.imageHeight }}px{% endif %}</td>
                        <td class="mobile-hidden uk-visible-xlarge">
                            {% if document.embedPlatform %}
                                {% set iconName = (document|embedFinder).shortType %}
                                {% if document.embedPlatform == 'unsplash' or document.embedPlatform == 'splashbase' %}
                                    {% set iconName = 'documents' %}
                                {% endif %}
                                {% import "@RoadizRozier/macros/rz_badge.html.twig" as rz_badge %}
                                {{ rz_badge.item({
                                    icon: 'rz-icon-ri--' ~ iconName ~ '-fill',
                                    attributes: {
                                        title: document.embedPlatform|trans|capitalize,
                                    }
                                }) }}
                            {% endif %}
                        </td>
                        <td>
                            {% include '@RoadizRozier/includes/rz_table_actions.html.twig' with {
                                'edit_href': path('documentsEditPage', { documentId: document.id }),
                                'delete_href': path('documentsDeletePage', { documentId: document.id }),
                            } %}
                        </td>
                    </tr>
                {% else %}
                    <tr class ><td class="rz-message__text" colspan="10">{% trans %}no_document{% endtrans %}</td></tr>
                {% endfor %}
            {% endblock %}
        {% endembed %}
    </article>
{% endblock %}
