{% import "@RoadizRozier/macros/rz_menu_bar.html.twig" as rz_menu_bar %}
{% if source %}
    {% set translation = source.translation %}
{% elseif available_translations[0] %}
    {# When no active source use available translation, not default one. #}
    {% set translation = available_translations[0] %}
{% endif %}
<nav class="rz-menu-bar">
    <ul class="rz-menu-bar__list">
        {%- if is_granted('EDIT_CONTENT', node) -%}
            {{ rz_menu_bar.item(
                name: 'source',
                label: 'node.content',
                href: path('nodesEditSourcePage', { nodeId: node.id, translationId: translation.id }),
                current: current
            ) }}
            {% if is_granted('EDIT_SETTING', node) %}
                {{ rz_menu_bar.item(
                    name: 'edit',
                    label: 'node.parameters',
                    href: path('nodesEditPage', { nodeId: node.id }),
                    current: current
                ) }}
            {% endif %}
            {% if is_granted('EDIT_TAGS', node) %}
                {{ rz_menu_bar.item(
                    name: 'tags',
                    label: 'tags',
                    href: path('nodesEditTagsPage', { nodeId: node.id }),
                    current: current
                ) }}
            {% endif %}
            {% if is_granted('EDIT_ATTRIBUTE', node) and getNodeType(node).attributable %}
                {{ rz_menu_bar.item(
                    name: 'attributes',
                    label: 'node.attributes',
                    href: path('nodesEditAttributesPage', { nodeId: node.id, translationId: translation.id }),
                    current: current
                ) }}
            {% endif %}
            {% block node_seo %}
                {{ rz_menu_bar.item(
                    name: 'seo',
                    label: 'seo',
                    href: path('nodesEditSEOPage', { nodeId: node.id, translationId: translation.id }),
                    current: current
                ) }}
            {% endblock %}
        {%- endif -%}
    </ul>
    {% if is_granted('READ', node) or is_granted('EDIT_REALMS', node) or is_granted('READ_LOGS', node) %}
        <ul class="rz-menu-bar__list">
            {% if is_granted('READ', node) %}
                {{ rz_menu_bar.item(
                    name: 'tree',
                    label: 'tree',
                    href: path('nodesTreePage', { nodeId: node.id, translationId: translation.id }),
                    current: current,
                    icon: 'rz-icon-ri--node-tree',
                    iconOnly: true,
                ) }}
            {% endif %}
            {% if is_granted('EDIT_REALMS', node) %}
                {{ rz_menu_bar.item(
                    name: 'realm',
                    label: 'realm_nodes',
                    href: path('nodesRealmsPage', { id: node.id }),
                    current: current,
                    icon: 'rz-icon-ri--spy-line',
                    iconOnly: true,
                ) }}
            {% endif %}
            {% if is_granted('READ_LOGS', node) %}
                {{ rz_menu_bar.item(
                    name: 'history',
                    label: 'history',
                    href: path('nodesHistoryPage', { nodeId: node.id }),
                    current: current,
                    icon: 'rz-icon-ri--history-line',
                    iconOnly: true,
                ) }}
            {% endif %}
        </ul>
    {% endif %}
    {% if block('additional_entries')|trim %}
        <ul class="rz-menu-bar__list">
            {% block additional_entries %}{% endblock %}
        </ul>
    {% endif %}
</nav>
