{% embed "@RoadizRozier/macros/rz_actions_menu.html.twig" with {
    vertical: true,
    class: 'actions-menu',
    versions: versions,
    currentVersion: currentVersion,
    tag: tag,
    translation: translation,
    readOnly: readOnly,
    loop: loop,
    max_versions_showed: max_versions_showed
} only %}
    {% block items %}
        {% if tag.id and (is_granted('ROLE_ACCESS_TAGS_DELETE') and not tag.locked and not readOnly) %}
            {{ _self.deleteItem(href: path('tagsDeletePage', { tagId: tag.getId })) }}
        {% endif %}
        {% if versions and versions|length > 1 %}
            {% set version_popover_id = 'version-popover-menu' %}
            <rz-popover
                popover-placement="left-start"
                popover-offset="18px"
            >
                {% import '@RoadizRozier/macros/rz_button.html.twig' as rz_button %}
                {{ rz_button.root({
                    icon: 'rz-icon-ri--git-fork-line',
                    emphasis: 'tertiary',
                    onDark: true,
                    attributes: {
                        'title': 'versions'|trans,
                        'popovertarget': version_popover_id,
                    }
                }) }}
                {% embed "@RoadizRozier/macros/rz_dropdown_menu.html.twig" with {
                    title: 'versions',
                    reverse: true,
                    targetId: version_popover_id,
                } %}
                    {% block items %}
                        {{ _self.item({
                            label: 'versions.working_copy',
                            href: path('tagsEditTranslatedPage', {
                                tagId: tag.id,
                                translationId: translation.id,
                            }),
                            selected: not currentVersion,
                        }) }}
                        {% for version in versions %}
                            {% if loop.index0 > 0 and loop.index <= max_versions_showed %}
                                {{ _self.item({
                                    label: version.loggedAt|format_datetime('short', 'short', locale=app.request.locale),
                                    description: version.username,
                                    href: path('tagsEditTranslatedPage', {
                                        tagId: tag.id,
                                        translationId: translation.id,
                                        version: version.version
                                    }),
                                    selected: currentVersion and currentVersion.id == version.id,
                                }) }}
                            {% endif %}
                        {% endfor %}
                    {% endblock %}
                {% endembed %}
            </rz-popover>
        {% endif %}
    {% endblock %}
{% endembed %}
